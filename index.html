<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#ffffff">
    <title>GPX Viewer</title>

    <!-- Vendored Leaflet CSS -->
    <link rel="stylesheet" href="vendor/leaflet/leaflet.css">

    <!-- Vendored Font Awesome -->
    <link rel="stylesheet" href="vendor/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="vendor/fontawesome/css/solid.min.css">

    <!-- App styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Full-screen map container -->
    <div id="map"></div>

    <!-- Floating Control Panel -->
    <div id="control-panel">
        <div class="panel-header">
            <h1 id="track-title">Loading...</h1>
            <span id="status-badge" class="status-badge hidden">
                <i class="fa-solid fa-circle-notch fa-spin"></i>
                <span id="status-text"></span>
            </span>
        </div>

        <div class="panel-controls">
            <!-- Unified Start Button -->
            <button id="btn-start" class="control-btn primary-btn" aria-label="Start tracking">
                <i class="fa-solid fa-play"></i>
            </button>

            <!-- Settings Button -->
            <button id="btn-settings" class="control-btn" aria-label="Open settings">
                <i class="fa-solid fa-gear"></i>
            </button>

            <!-- Open Full Page (Embed mode only) -->
            <button id="btn-open-full" class="control-btn hidden" aria-label="Open in new tab">
                <i class="fa-solid fa-arrow-up-right-from-square"></i>
            </button>
        </div>
    </div>

    <!-- Settings Panel (Popover/Modal) -->
    <div id="settings-overlay" class="hidden">
        <div id="settings-panel">
            <div class="settings-header">
                <h2>Settings</h2>
                <button id="btn-close-settings" class="close-btn" aria-label="Close settings">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>

            <div class="settings-section">
                <h3>Sharing</h3>
                <div class="settings-grid">
                    <button id="btn-share" class="settings-btn">
                        <i class="fa-solid fa-share-nodes"></i>
                        <span>Share Track</span>
                    </button>
                    <button id="btn-copy-embed" class="settings-btn">
                        <i class="fa-solid fa-code"></i>
                        <span>Embed Code</span>
                    </button>
                </div>
            </div>

            <div class="settings-section">
                <h3>Advanced Controls</h3>
                <div class="toggle-row">
                    <span>GPS Tracking</span>
                    <label class="switch">
                        <input type="checkbox" id="toggle-gps">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="toggle-row">
                    <span>Lock-on-User</span>
                    <label class="switch">
                        <input type="checkbox" id="toggle-lock">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="toggle-row">
                    <span>Compass Heading</span>
                    <label class="switch">
                        <input type="checkbox" id="toggle-heading">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-footer">
                <button id="btn-full-page-fallback" class="full-width-btn">
                    <i class="fa-solid fa-expand"></i>
                    Open Full Page
                </button>
            </div>
        </div>
    </div>

    <!-- Toast container for notifications -->
    <div id="toast-container"></div>

    <!-- Vendored Leaflet JS -->
    <script src="vendor/leaflet/leaflet.js"></script>

    <!-- Vendored leaflet-gpx plugin -->
    <script src="vendor/leaflet-gpx/gpx.js"></script>

    <!-- App script -->
    <script src="app.js"></script>
</body>

</html>